{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const apiUrl=\"https://techbuggy-1.onrender.com\";const Profile=()=>{const[user,setUser]=useState(null);const[bookings,setBookings]=useState([]);const[loading,setLoading]=useState(true);const navigate=useNavigate();useEffect(()=>{const fetchProfile=async()=>{const token=localStorage.getItem(\"token\");if(!token){navigate(\"/login\");return;}try{const res=await fetch(\"\".concat(apiUrl,\"/api/auth/profile\"),{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(token)}});const data=await res.json();if(!res.ok){console.error(data.message);return;}setUser(data.user);setBookings(data.user.bookings||[]);}catch(err){console.error(\"Error fetching profile:\",err);}finally{setLoading(false);}};fetchProfile();},[navigate]);const cancelBooking=async bookingId=>{const token=localStorage.getItem(\"token\");try{const res=await fetch(\"\".concat(apiUrl,\"/api/bookings/\").concat(bookingId),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(token)}});const data=await res.json();if(!res.ok){alert(data.message||\"Failed to cancel booking\");return;}// Remove booking from UI\nsetBookings(prev=>prev.filter(b=>b._id!==bookingId));}catch(err){console.error(\"Error canceling booking:\",err);}};if(loading)return/*#__PURE__*/_jsx(\"p\",{className:\"pt-24 text-center\",children:\"Loading profile...\"});return/*#__PURE__*/_jsx(\"div\",{className:\"pt-24 px-6 md:px-12 lg:px-20\",children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-3xl font-bold mb-6\",children:[\"Welcome, \",/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-600\",children:user.name})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"Your Bookings\"}),bookings.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No bookings yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\",children:bookings.map(booking=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow-lg rounded-lg p-5 border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-orange-600\",children:booking.destinationName}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Date: \",new Date(booking.date).toLocaleDateString()]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Persons: \",booking.persons]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-800 font-semibold\",children:[\"Price: \\u20B9\",booking.price]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2 font-medium \".concat(booking.status===\"cancelled\"?\"text-red-500\":\"text-green-600\"),children:[\"Status: \",booking.status]}),booking.status!==\"cancelled\"&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>cancelBooking(booking._id),className:\"mt-4 w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg transition\",children:\"Cancel\"})]},booking._id))})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500\",children:\"User not found\"})});};export default Profile;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","apiUrl","Profile","user","setUser","bookings","setBookings","loading","setLoading","navigate","fetchProfile","token","localStorage","getItem","res","fetch","concat","method","headers","Authorization","data","json","ok","console","error","message","err","cancelBooking","bookingId","alert","prev","filter","b","_id","className","children","name","length","map","booking","destinationName","Date","date","toLocaleDateString","persons","price","status","onClick"],"sources":["C:/Users/CH.LAKSHMI JAHNAVI/Desktop/Techbuggy/frontend/src/components/profile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst apiUrl = \"https://techbuggy-1.onrender.com\";\r\n\r\nconst Profile = () => {\r\n  const [user, setUser] = useState(null);\r\n  const [bookings, setBookings] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchProfile = async () => {\r\n      const token = localStorage.getItem(\"token\");\r\n      if (!token) {\r\n        navigate(\"/login\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const res = await fetch(`${apiUrl}/api/auth/profile`, {\r\n          method: \"GET\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        });\r\n\r\n        const data = await res.json();\r\n\r\n        if (!res.ok) {\r\n          console.error(data.message);\r\n          return;\r\n        }\r\n\r\n        setUser(data.user);\r\n        setBookings(data.user.bookings || []);\r\n      } catch (err) {\r\n        console.error(\"Error fetching profile:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProfile();\r\n  }, [navigate]);\r\n\r\n  const cancelBooking = async (bookingId) => {\r\n    const token = localStorage.getItem(\"token\");\r\n    try {\r\n      const res = await fetch(`${apiUrl}/api/bookings/${bookingId}`, {\r\n        method: \"PUT\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok) {\r\n        alert(data.message || \"Failed to cancel booking\");\r\n        return;\r\n      }\r\n\r\n      // Remove booking from UI\r\n      setBookings((prev) => prev.filter((b) => b._id !== bookingId));\r\n    } catch (err) {\r\n      console.error(\"Error canceling booking:\", err);\r\n    }\r\n  };\r\n\r\n  if (loading) return <p className=\"pt-24 text-center\">Loading profile...</p>;\r\n\r\n  return (\r\n    <div className=\"pt-24 px-6 md:px-12 lg:px-20\">\r\n      {user ? (\r\n        <>\r\n          <h1 className=\"text-3xl font-bold mb-6\">\r\n            Welcome, <span className=\"text-orange-600\">{user.name}</span>\r\n          </h1>\r\n\r\n          <h2 className=\"text-2xl font-semibold mb-4\">Your Bookings</h2>\r\n\r\n          {bookings.length === 0 ? (\r\n            <p className=\"text-gray-500\">No bookings yet.</p>\r\n          ) : (\r\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n              {bookings.map((booking) => (\r\n                <div\r\n                  key={booking._id}\r\n                  className=\"bg-white shadow-lg rounded-lg p-5 border border-gray-200\"\r\n                >\r\n                  <h3 className=\"text-xl font-bold text-orange-600\">\r\n                    {booking.destinationName}\r\n                  </h3>\r\n                  <p className=\"text-gray-600\">\r\n                    Date: {new Date(booking.date).toLocaleDateString()}\r\n                  </p>\r\n                  <p className=\"text-gray-600\">Persons: {booking.persons}</p>\r\n                  <p className=\"text-gray-800 font-semibold\">\r\n                    Price: â‚¹{booking.price}\r\n                  </p>\r\n                  <p\r\n                    className={`mt-2 font-medium ${\r\n                      booking.status === \"cancelled\"\r\n                        ? \"text-red-500\"\r\n                        : \"text-green-600\"\r\n                    }`}\r\n                  >\r\n                    Status: {booking.status}\r\n                  </p>\r\n\r\n                  {booking.status !== \"cancelled\" && (\r\n                    <button\r\n                      onClick={() => cancelBooking(booking._id)}\r\n                      className=\"mt-4 w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg transition\"\r\n                    >\r\n                      Cancel\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </>\r\n      ) : (\r\n        <p className=\"text-red-500\">User not found</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}